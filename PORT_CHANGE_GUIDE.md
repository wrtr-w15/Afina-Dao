# üîå –ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—Ç Next.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## üìã –°–ø–æ—Å–æ–±—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Ä—Ç–∞

### 1Ô∏è‚É£ **–ß–µ—Ä–µ–∑ .env.local (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**

–û—Ç–∫—Ä–æ–π—Ç–µ `frontend/.env.local` –∏ –∏–∑–º–µ–Ω–∏—Ç–µ/–¥–æ–±–∞–≤—å—Ç–µ:

\`\`\`env
PORT=3001
NEXT_PUBLIC_API_URL=http://localhost:3001
\`\`\`

**–ó–∞—Ç–µ–º –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:**
\`\`\`bash
npm start
\`\`\`

---

### 2Ô∏è‚É£ **–ß–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è**

\`\`\`bash
# Development
PORT=3001 npm run dev

# Production
PORT=3001 npm start
\`\`\`

---

### 3Ô∏è‚É£ **–ß–µ—Ä–µ–∑ package.json**

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `frontend/package.json`:

\`\`\`json
{
  "scripts": {
    "dev": "next dev -p 3001",
    "start": "next start -p 3001"
  }
}
\`\`\`

---

### 4Ô∏è‚É£ **–ß–µ—Ä–µ–∑ PM2 (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)**

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `ecosystem.config.js`:

\`\`\`javascript
module.exports = {
  apps: [{
    name: 'afina-dao',
    script: 'npm',
    args: 'start',
    env: {
      NODE_ENV: 'production',
      PORT: 3001  // ‚Üê –ò–∑–º–µ–Ω–∏—Ç–µ –∑–¥–µ—Å—å
    }
  }]
};
\`\`\`

–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ:
\`\`\`bash
pm2 restart afina-dao
\`\`\`

---

## ‚ö†Ô∏è –í–∞–∂–Ω–æ! –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Ä—Ç–∞:

### 1. –û–±–Ω–æ–≤–∏—Ç–µ NEXT_PUBLIC_API_URL

–í `.env.local`:
\`\`\`env
NEXT_PUBLIC_API_URL=http://localhost:–ù–û–í–´–ô_–ü–û–†–¢
\`\`\`

### 2. –û–±–Ω–æ–≤–∏—Ç–µ Nginx (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

–í `/etc/nginx/sites-available/afina-dao`:

\`\`\`nginx
upstream nextjs_upstream {
    server 127.0.0.1:–ù–û–í–´–ô_–ü–û–†–¢;  # ‚Üê –ò–∑–º–µ–Ω–∏—Ç–µ –∑–¥–µ—Å—å
}
\`\`\`

–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Nginx:
\`\`\`bash
sudo nginx -t
sudo systemctl restart nginx
\`\`\`

### 3. –û–±–Ω–æ–≤–∏—Ç–µ —Ñ–∞–π—Ä–≤–æ–ª (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)

\`\`\`bash
# –†–∞–∑—Ä–µ—à–∏—Ç—å –Ω–æ–≤—ã–π –ø–æ—Ä—Ç
sudo ufw allow –ù–û–í–´–ô_–ü–û–†–¢/tcp

# –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π (–µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
sudo ufw delete allow 3000/tcp
\`\`\`

### 4. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç

\`\`\`bash
cd frontend
npm run build
npm start
\`\`\`

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤–æ–≥–æ –ø–æ—Ä—Ç–∞

\`\`\`bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –ø–æ—Ä—Ç —Å–ª—É—à–∞–µ—Ç—Å—è
lsof -i:–ù–û–í–´–ô_–ü–û–†–¢

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ curl
curl http://localhost:–ù–û–í–´–ô_–ü–û–†–¢

# –ü—Ä–æ–≤–µ—Ä–∫–∞ API
curl http://localhost:–ù–û–í–´–ô_–ü–û–†–¢/api/projects
\`\`\`

---

## üìä –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø–æ—Ä—Ç—ã –¥–ª—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

| –ü–æ—Ä—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| 3000 | Next.js –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
| 3001 | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –¥–ª—è Next.js |
| 8080 | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π HTTP |
| 8000 | –ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è API |
| 4000 | GraphQL —Å–µ—Ä–≤–µ—Ä—ã |
| 5000 | Flask, –¥—Ä—É–≥–∏–µ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏ |

---

## ‚ö° –ë—ã—Å—Ç—Ä–∞—è —Å–º–µ–Ω–∞ –ø–æ—Ä—Ç–∞ (–æ–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞)

\`\`\`bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Å–µ—Ä–≤–µ—Ä
lsof -ti:3000 | xargs kill -9

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –Ω–∞ –Ω–æ–≤–æ–º –ø–æ—Ä—Ç—É
cd frontend
PORT=3001 npm start

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
curl http://localhost:3001
\`\`\`

---

## üêõ –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –û—à–∏–±–∫–∞: "Port already in use"

\`\`\`bash
# –ù–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞ –ø–æ—Ä—Ç—É
lsof -i:3000

# –£–±–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å
kill -9 PID

# –ò–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
lsof -ti:3000 | xargs kill -9
\`\`\`

### –û—à–∏–±–∫–∞: "Cannot find module"

\`\`\`bash
# –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
rm -rf node_modules package-lock.json
npm install
npm run build
\`\`\`

### –°–∞–π—Ç –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –Ω–æ–≤–æ–º –ø–æ—Ä—Ç—É

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `.env.local`:
   \`\`\`bash
   cat .env.local | grep PORT
   \`\`\`

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –∑–∞–ø—É—â–µ–Ω –ª–∏ —Å–µ—Ä–≤–µ—Ä:
   \`\`\`bash
   lsof -i:–ù–û–í–´–ô_–ü–û–†–¢
   \`\`\`

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
   \`\`\`bash
   pm2 logs afina-dao
   \`\`\`

---

## üìù –ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞ –ø–æ—Ä—Ç 8080

### 1. –û–±–Ω–æ–≤–∏—Ç–µ .env.local:
\`\`\`env
PORT=8080
NEXT_PUBLIC_API_URL=http://localhost:8080
\`\`\`

### 2. –û–±–Ω–æ–≤–∏—Ç–µ ecosystem.config.js:
\`\`\`javascript
env: {
  PORT: 8080
}
\`\`\`

### 3. –û–±–Ω–æ–≤–∏—Ç–µ Nginx:
\`\`\`nginx
upstream nextjs_upstream {
    server 127.0.0.1:8080;
}
\`\`\`

### 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ:
\`\`\`bash
npm run build
pm2 restart afina-dao
sudo systemctl restart nginx
\`\`\`

### 5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
\`\`\`bash
curl http://localhost:8080
\`\`\`

---

**–ì–æ—Ç–æ–≤–æ!** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –Ω–æ–≤–æ–º –ø–æ—Ä—Ç—É üéâ
